# 1W / 1M / 12M 봉 수집 규칙 (명세)

## Binance 기준 → 한국 시간(KST) 환산

Binance는 **UTC 00:00** 기준으로 봉을 잡는다.

| 봉 | Binance 예시 (날짜) | UTC 시각 | KST 시각 |
|----|---------------------|----------|----------|
| **1W** | 26년 2월 9일, 26년 2월 2일 | 해당일 **00:00 UTC** (월요일) | 해당일 **09:00 KST** (월요일 오전 9시) |
| **1M** | 26년 1월 1일, 26년 2월 1일 | 해당일 **00:00 UTC** (매월 1일) | 해당일 **09:00 KST** (매월 1일 오전 9시) |
| **12M** | 매년 1월 1일 | **1월 1일 00:00 UTC** | **1월 1일 09:00 KST** |

즉, **1W·1M·12M 모두 Binance는 UTC 00:00 = KST 09:00** 이다.

---

## 우리 서비스 규칙: KST 00:00 기준

요청대로 **한국 시간 00:00** 으로 통일한다.

| 봉 | 수집 규칙 (candle_start_at 기준) | 수집 시점 |
|----|-----------------------------------|-----------|
| **1W** | **월요일 00:00 KST** 에 시작하는 주봉 (월 00:00 ~ 다음 월 00:00). 7일치 1d(KST) 집계. | 해당 주가 끝난 뒤(다음 월 00:01 KST 등) 수집 |
| **1M** | **매월 1일 00:00 KST** 에 시작하는 월봉 (1일 00:00 ~ 다음 달 1일 00:00). 해당 월 1d(KST) 집계. | **26년 1월 1일 00:00 KST, 26년 2월 1일 00:00 KST** 등에 각각 수집 |
| **12M** | **매년 1월 1일 00:00 KST** 에 시작하는 연봉. 전년 1월 1일 00:00 ~ 당해 1월 1일 00:00, 12개월 1d(KST) 집계. | **매년 1월 1일 00:00 KST** 에 수집 |

- **1W**: 월요일 00:00 KST = 해당 주의 시작.  
- **1M**: 1일 00:00 KST = 해당 월의 시작.  
- **12M**: 1월 1일 00:00 KST = 해당 연도의 시작.  

구현은 모두 **이미 KST 00:00 기준인 btc_1d** 를 묶어서 1W/1M/12M을 만든다.

---

## 수집·정산은 해당 날만

- **1W**: **월요일**에만 수집·정산 (방금 마감된 주봉).
- **1M**: **매월 1일**에만 수집·정산 (방금 마감된 월봉).
- **12M**: **매년 1월 1일**에만 수집·정산 (방금 마감된 연봉).

daily cron은 매일 00:01 KST에 돌지만, 1W/1M/12M은 위 조건일 때만 수집·정산한다.
